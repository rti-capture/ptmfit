inspired by the original  by Tom Malzbender
libvips conversion by John Cupitt
